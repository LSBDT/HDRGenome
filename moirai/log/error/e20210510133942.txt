https://moirai2.github.io/schema/daemon/command	moirai/log/json/j20210510133941.json
https://moirai2.github.io/schema/daemon/command/line	outdir=$project/stats;perl bin/statdel.pl -o $outdir $hdr;output=`ls $outdir/$case*`
https://moirai2.github.io/schema/daemon/execute	error
https://moirai2.github.io/schema/daemon/timeended	1620621585
https://moirai2.github.io/schema/daemon/timestarted	1620621585
https://moirai2.github.io/schema/daemon/timethrown	1620621585
moirai/log/json/j20210510133941.json#case	NA18940_v2
moirai/log/json/j20210510133941.json#hdr	testDD/hdr/NA18940_v2/NA18940_v2.hom_region1000000_pick1_skip0_dd.txt
moirai/log/json/j20210510133941.json#output	testDD/stats/NA18940_v2.hom_region1000000_pick1_skip0_dd.out
moirai/log/json/j20210510133941.json#project	testDD
======================================== stderr ========================================
/Users/ah3q/Sites/github/HDRGenome/bin/mac/statdel /var/folders/12/f5vg17pn5c76pg7wccd147kw0000gp/T/iMs0DfQ_O_
======================================== bash ========================================
#!/bin/sh
########## system ##########
cmdurl="moirai/log/json/j20210510133941.json"
execid="e20210510133942"
rootdir="/Users/ah3q/Sites/github/HDRGenome"
ctrldir="moirai/ctrl"
workdir="moirai/e20210510133942"
tmpdir="moirai/e20210510133942/tmp"
completedfile="e20210510133942.completed"
insertfile="e20210510133942.insert"
logfile="e20210510133942.log"
stdoutfile="e20210510133942.stdout"
stderrfile="e20210510133942.stderr"
cd $rootdir
########## variables ##########
case="NA18940_v2"
hdr="testDD/hdr/NA18940_v2/NA18940_v2.hom_region1000000_pick1_skip0_dd.txt"
project="testDD"
########## open tmpdir ##########
mkdir -p /tmp/$execid
ln -s /tmp/$execid $rootdir/$workdir/tmp
########## initialize ##########
echo "$execid	https://moirai2.github.io/schema/daemon/timestarted	`date +%s`">>$workdir/$logfile
########## command ##########
outdir=$project/stats
perl bin/statdel.pl -o $outdir $hdr
output=`ls $outdir/$case*`
########## database ##########
echo "$execid	https://moirai2.github.io/schema/daemon/timeended	`date +%s`">>$workdir/$logfile
if [[ "$(declare -p output)" =~ "declare -a" ]]; then
for out in ${output[@]} ; do
echo "$execid	$cmdurl#output	$out">>$workdir/$logfile
echo "$case	$project/stats	$out">>$workdir/$insertfile
done
else
echo "$execid	$cmdurl#output	$output">>$workdir/$logfile
echo "$case	$project/stats	$output">>$workdir/$insertfile
fi
########## close tmpdir ##########
rm $workdir/tmp
if [ -z "$(ls -A /tmp/$execid)" ]; then
rmdir /tmp/$execid
else
mv /tmp/$execid $workdir/tmp
fi
########## check stdout ##########
if [ "$(grep 'Results in file' $workdir/$stdoutfile)" != "" ]; then
rm $workdir/$stdoutfile
fi
########## completed ##########
mv $workdir/$completedfile $ctrldir/completed/.
